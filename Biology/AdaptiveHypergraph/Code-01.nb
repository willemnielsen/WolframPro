(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[      5684,        154]
NotebookOptionsPosition[      5180,        133]
NotebookOutlinePosition[      5572,        149]
CellTagsIndexPosition[      5529,        146]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"MutateHypergraphRule", "[", "rule_Rule", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lhs", ",", "rhs", ",", "vertices", ",", 
      RowBox[{"try", "=", "0"}], ",", 
      RowBox[{"maxTries", "=", "1000"}], ",", "side", ",", "edges", ",", "i", 
      ",", "edge", ",", "pos", ",", "candidates", ",", "newVertex", ",", 
      "mutatedEdge", ",", "newEdges", ",", "newRule", ",", "maxV"}], "}"}], ",", 
    RowBox[{
     RowBox[{"lhs", "=", 
      RowBox[{"First", "[", "rule", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rhs", "=", 
      RowBox[{"Last", "[", "rule", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vertices", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{"lhs", ",", "rhs"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxV", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"vertices", "===", 
         RowBox[{"{", "}"}]}], ",", "0", ",", 
        RowBox[{"Max", "[", "vertices", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"try", "<", "maxTries"}], ",", 
       RowBox[{
        RowBox[{"try", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"side", "=", 
         RowBox[{"RandomChoice", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edges", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"side", "==", "1"}], ",", "lhs", ",", "rhs"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "edges", "]"}], "==", "0"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "edges", "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edge", "=", 
         RowBox[{"edges", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "edge", "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"candidates", "=", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"vertices", ",", 
             RowBox[{"edge", "[", 
              RowBox[{"[", "pos", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"maxV", "+", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"candidates", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"newVertex", "=", 
         RowBox[{"RandomChoice", "[", "candidates", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mutatedEdge", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"pos", "->", "newVertex"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newEdges", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"edges", ",", 
           RowBox[{"i", "->", "mutatedEdge"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newRule", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"side", "==", "1"}], ",", 
           RowBox[{"newEdges", "->", "rhs"}], ",", 
           RowBox[{"lhs", "->", "newEdges"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "ResourceFunction", "[", "\"\<ConnectedHypergraphQ\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"Keys", "@", "newRule"}], "/.", " ", 
             RowBox[{"Rule", "->", "Identity"}]}], "]"}], "&&", 
           RowBox[{
            RowBox[{
            "ResourceFunction", "[", "\"\<ConnectedHypergraphQ\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"Values", "@", "newRule"}], "/.", " ", 
             RowBox[{"Rule", "->", "Identity"}]}], "]"}]}], ",", 
          RowBox[{"Return", "[", "newRule", "]"}]}], "]"}], ";"}]}], "]"}], ";",
      "\[IndentingNewLine]", "$Failed"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9580916380218363`*^9, 
  3.958091638024571*^9}},ExpressionUUID->"d3a49a6a-693b-45ae-af03-\
75289b24bb77"]
},
WindowSize->{808, 756},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e1646a48-2639-434f-89ad-8efbd28119e9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 4776, 118, 478, "Input",ExpressionUUID->"d3a49a6a-693b-45ae-af03-75289b24bb77"]
}
]
*)

